<!DOCTYPE HTML>
<html lang="en" class="steinberg-light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Drag-and-Drop Sample Import - HALion 7.1.30</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="shortcut icon" href="../../resources/favicon/favicon-16x16.png" type="image/png">
        <link rel="shortcut icon" href="../../resources/favicon/favicon-32x32.png" type="image/png">
        <link rel="shortcut icon" href="../../resources/favicon/favicon-192x192.png" type="image/png">
        <link rel="shortcut icon" href="../../resources/favicon/favicon-256x256.png" type="image/png">

        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "steinberg-dark" : "steinberg-light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('steinberg-light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="steinberg-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="steinberg-dark">Dark</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">HALion 7.1.30</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p>/ <a href="../../HALion-Developer-Resource.html">HALion Developer Resource</a> / <a href="./HALion-Tutorials-Guidelines.html">HALion Tutorials &amp; Guidelines</a> / <a href="./How-tos.html">How-tos</a> /</p>
<h1 id="drag-and-drop-sample-import"><a class="header" href="#drag-and-drop-sample-import">Drag-and-Drop Sample Import</a></h1>
<p>For your macro page to accept sample import by drag and drop, you need a <a href="../../HALion-Macro-Page/pages/Drop.html">Drop</a> control, the <a href="../../HALion-Macro-Page/pages/Sample-Display.html">Sample Display</a> template, and a UI script.</p>
<h2 id="example-vst-preset"><a class="header" href="#example-vst-preset">Example VST Preset</a></h2>
<ul>
<li><a href="../vstpresets/Drag-and-Drop%20Sample%20Import.vstpreset">Drag-and-Drop Sample Import.vstpreset</a></li>
</ul>
<p><img src="../images/Drag-and-Drop-Sample-Import.png" alt="Drag-and-Drop Sample Import" /></p>
<p>The following section describes how to access <a href="../../HALion-Macro-Page/pages/Template.html">Templates</a> and edit UI scripts.</p>
<ul>
<li>Load <a href="../vstpresets/Drag-and-Drop%20Sample%20Import.vstpreset">Drag-and-Drop Sample Import.vstpreset</a>.</li>
</ul>
<p><strong>To explore the templates in this example:</strong></p>
<ol>
<li>Open the <strong>Macro Page Designer</strong>, go to the <strong>Templates Tree</strong> and select the template that you want to explore.</li>
<li>Click <strong>Edit Element</strong> <img src="../images/EditElement.PNG" alt="Edit Element" /> to examine the template.</li>
</ol>
<p><strong>To edit the UI script:</strong></p>
<ol>
<li>Open the <strong>Macro Page Designer</strong> and select the topmost element in the <strong>GUI Tree</strong>.</li>
<li>Go to the Properties section and click <strong>Edit Script</strong> <img src="../images/EditElement.PNG" alt="Edit Element" /> to open the internal script editor.</li>
</ol>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<ul>
<li>You have a program that contains a sample zone and a macro page.</li>
</ul>
<h2 id="how-the-elements-interact"><a class="header" href="#how-the-elements-interact">How the Elements Interact</a></h2>
<h3 id="sample-display"><a class="header" href="#sample-display">Sample Display</a></h3>
<p>The <a href="../../HALion-Macro-Page/pages/Sample-Display.html">Sample Display</a> template is the same as the one that comes with the <a href="../../HALion-Macro-Page/pages/Exploring-Templates.html#basic-controls">Basic Controls</a> library. The <strong>Template Parameters</strong> of the <a href="../../HALion-Macro-Page/pages/Sample-Display.html">Sample Display</a> template are fixed, displaying only the waveform, not the FFT. The Scope defines the zone where the sample is loaded, here <code>@0:Sample Zone</code>. See <a href="../../HALion-Macro-Page/pages/Sample-Display.html#template-parameters">Sample Display &gt; Template Parameters</a> for further details.</p>
<p><img src="../images/Drag-and-Drop-Sample-Import-Sample-Display.png" alt="Sample Display" /></p>
<p>You can find more properties inside the <a href="../../HALion-Macro-Page/pages/Sample-Display.html">Sample Display</a> template. The screenshot shows how they are set up.</p>
<p><img src="../images/Drag-and-Drop-Sample-Import-Sample-Display-Properties.png" alt="Sample Display Properties" /></p>
<p>In the current example, the original UI script that came with the <a href="../../HALion-Macro-Page/pages/Sample-Display.html">Sample Display</a> template has been replaced with the UI script on the macro page, primarily to implement the <a href="../../HALion-Macro-Page/pages/Drag-Group.html#drag-group-callbacks">Drag Group Callbacks</a> needed for the drag-and-drop functionality. <a href="../../HALion-Macro-Page/pages/Drag-Group.html#drag-group-callbacks">Drag Group Callbacks</a> are called when you drop something on a <a href="../../HALion-Macro-Page/pages/Drop.html">Drop</a> control.</p>
<h3 id="sampledroparea"><a class="header" href="#sampledroparea">SampleDropArea</a></h3>
<p>The <a href="../../HALion-Macro-Page/pages/Drop.html">Drop</a> control is named 'SampleDropArea' and has the same position and size as the <a href="../../HALion-Macro-Page/pages/Sample-Display.html">Sample Display</a> template.</p>
<p><img src="../images/Drag-and-Drop-Sample-Import-SampleDropArea.png" alt="SampleDropArea" /></p>
<p>Its name 'SampleDropArea' is used by the <a href="../../HALion-Macro-Page/pages/Drag-Group.html#drag-group-callbacks">Drag Group Callbacks</a> as a condition for calling other functions to import the sample. The sample import as implemented in the UI script supports sample files from the hard disk as well as regions from Cubase. Take a look at the <code>firstRegion</code> function for more details on this.</p>
<pre><code class="language-lua">-- Drag &amp; Drop Sample Import

zone   = getElement():getZone()

function firstRegion(data)
	if data then
		if data.files and data.files[1] then
			local af = AudioFile.open(data.files[1])
			if af.valid then
				return af, 0, af.length
			end
		end
		if data.regions and data.regions[1] then
			local af = AudioFile.open(data.regions[1].filename)
			if af.valid then
				return af, data.regions[1].start, data.regions[1].length
			end
		end
	end
	return { valid = false }, 0, -1
end

function onDropFeedback(viewname, draginfo, copy, data)
	if viewname == "SampleDropArea" then
		local af, start, length = firstRegion(data)
		return af.valid
	end
end

function onDropGetInfo(viewname, info)
	return { info = info, copy = true, move = false }
end

function importSample(sample, start, length)
	if sample.valid then
		startUndoBlock("Import Sample " .. sample.fileName)
		zone:setParameter("SampleOsc.Filename", sample.fileName)
		zone:setParameter("SampleOsc.SampleStart", start)
		zone:setParameter("SampleOsc.SampleEnd", start + length)
		-- check loops
		local loop = sample.loops[1]
		zone:setParameter("SampleOsc.SustainLoopModeA", 1)
		local ls = loop and (loop.loopStart &lt; loop.loopEnd) and math.max(start, math.min(loop.loopStart, start + length)) or start
		local le = loop and (loop.loopStart &lt; loop.loopEnd) and math.max(start, math.min(loop.loopEnd,   start + length)) or start + length
		zone:setParameter("SampleOsc.SustainLoopStartA", ls)
		zone:setParameter("SampleOsc.SustainLoopEndA", le)
		endUndoBlock()
		SampleFileName = sample.fileName
	end
end

function onDropInsert(viewname, draginfo, copy, data)
	if viewname == "SampleDropArea" then
		local sample, start, length = firstRegion(data)
		importSample(sample, start, length)
	end
end

defineParameter("SampleFileName", nil, "Drag a sample onto the waveform display to import it.")
</code></pre>
<h3 id="info"><a class="header" href="#info">Info</a></h3>
<p>Hovering over the 'Info' button on the macro page displays the file path of the sample. The 'Info Button' <a href="../../HALion-Macro-Page/pages/Template.html">Template</a> and the 'Info' <a href="../../HALion-Macro-Page/pages/Disable.html">Disable Group</a> are both linked to the <code>@SampleInfo</code> UI variable, which controls whether the 'Info' <a href="../../HALion-Macro-Page/pages/Disable.html">Disable Group</a> and its contents are displayed. The 'Info' <a href="../../HALion-Macro-Page/pages/Disable.html">Disable Group</a> contains a <a href="../../HALion-Macro-Page/pages/Text.html">Text</a> and a <a href="../../HALion-Macro-Page/pages/Decor-Control.html">Decor</a> control. The information to be displayed by the <a href="../../HALion-Macro-Page/pages/Text.html">Text</a> control is set by the <code>SampleFileName</code> parameter of the UI script.</p>
<p><img src="../images/Drag-and-Drop-Sample-Import-Text.png" alt="Text Control" /></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../HALion-Tutorials-Guidelines/pages/Custom-Popup-Menus.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../HALion-Tutorials-Guidelines/pages/Dynamic-Template-References.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>

            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../HALion-Tutorials-Guidelines/pages/Custom-Popup-Menus.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../HALion-Tutorials-Guidelines/pages/Dynamic-Template-References.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>
            
            <div id="footer" class="footer">
                <!-- Here comes the footer when available -->
                © 2025 <a href="https://www.steinberg.net" target="_blank">Steinberg Media Technologies GmbH</a>.&nbsp; All rights reserved.&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="https://o.steinberg.net/en/extras/about.html" target="_blank">About</a> |
                <a href="https://o.steinberg.net/en/extras/privacy_policy.html" target="_blank">Privacy Policy</a> |
                <a href="https://o.steinberg.net/en/extras/terms_conditions.html" target="_blank">Legal Terms</a> 
            </div>
        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../mermaid.min.js"></script>
        <script src="../../mermaid-init.js"></script>


    </div>
    </body>
</html>
