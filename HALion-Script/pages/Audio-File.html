<!DOCTYPE HTML>
<html lang="en" class="steinberg-light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Audio File - HALion 7.1.30</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="shortcut icon" href="../../resources/favicon/favicon-16x16.png" type="image/png">
        <link rel="shortcut icon" href="../../resources/favicon/favicon-32x32.png" type="image/png">
        <link rel="shortcut icon" href="../../resources/favicon/favicon-192x192.png" type="image/png">
        <link rel="shortcut icon" href="../../resources/favicon/favicon-256x256.png" type="image/png">

        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "steinberg-dark" : "steinberg-light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('steinberg-light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="steinberg-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="steinberg-dark">Dark</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">HALion 7.1.30</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p>/ <a href="../../HALion-Developer-Resource.html">HALion Developer Resource</a> / <a href="./HALion-Script.html">HALion Script</a> / <a href="./Class-Reference.html">Class Reference</a> /</p>
<h1 id="audio-file"><a class="header" href="#audio-file">Audio File</a></h1>
<p>The AudioFile class describes the properties of audio files.</p>
<hr />
<p><strong>On this page:</strong></p>
<p><a href="#audiofile-class">AudioFile Class</a>, <a href="#analyzepitch">analyzePitch</a>, <a href="#canceldecompose">cancelDecompose</a>, <a href="#cancelpitchanalysis">cancelPitchAnalysis</a>, <a href="#decompose">decompose</a>, <a href="#getdecomposeprogress">getDecomposeProgress</a>, <a href="#getonsets">getOnsets</a>, <a href="#getpeak">getPeak</a>, <a href="#getpitch">getPitch</a>, <a href="#getpitchanalysisprogress">getPitchAnalysisProgress</a></p>
<hr />
<h2 id="classes"><a class="header" href="#classes">Classes</a></h2>
<h3 id="audiofile-class"><a class="header" href="#audiofile-class">AudioFile Class</a></h3>
<h4 id="description"><a class="header" href="#description">Description</a></h4>
<p>The <a href="./AudioFileopen.html">AudioFile.open</a> function creates an AudioFile object of the specified audio file. The AudioFile object can be used to retrieve information from the audio file, for example, the sample rate, bit depth, length in samples, etc. The AudioFile object has the following fields.</p>
<blockquote>
<p>❕ All fields of the AudioFile object are read-only.</p>
</blockquote>
<p><strong>Available in:</strong> Controller, Processor.</p>
<h4 id="fields"><a class="header" href="#fields">Fields</a></h4>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Field</th><th style="text-align: left">Description</th><th style="text-align: left">Value Type</th></tr></thead><tbody>
<tr><td style="text-align: left"><strong>.valid</strong></td><td style="text-align: left">Indicates if the file is a supported audio file and whether it could be opened or not.</td><td style="text-align: left">boolean</td></tr>
<tr><td style="text-align: left"><strong>.fileName</strong></td><td style="text-align: left">The file name that was used for opening the audio file.</td><td style="text-align: left">string</td></tr>
<tr><td style="text-align: left"><strong>.rate</strong></td><td style="text-align: left">The sample rate of the audio file. Returns <code>nil</code> if the audio file could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.bits</strong></td><td style="text-align: left">The bit depth of the audio file. Returns <code>nil</code> if the audio file could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.channels</strong></td><td style="text-align: left">The number of channels of the audio file. Returns <code>nil</code> if the audio file could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.length</strong></td><td style="text-align: left">The number of samples in the audio file. Returns <code>nil</code> if the audio file could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.rootKey</strong></td><td style="text-align: left">The root key stored in the sampler chunk of the audio file. Returns <code>nil</code> if the audio file does not contain an appropriate sampler chunk or could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.keyLow</strong></td><td style="text-align: left">The lowest key of the key range stored in the sampler chunk of the audio file. Returns <code>nil</code> if the audio file does not contain an appropriate sampler chunk or could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.keyHigh</strong></td><td style="text-align: left">The highest key of the key range stored in the sampler chunk of the audio file. Returns <code>nil</code> if the audio file does not contain an appropriate sampler chunk or could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.velLow</strong></td><td style="text-align: left">The lowest velocity of the velocity range stored in the sampler chunk of the audio file. Returns <code>nil</code> if the audio file does not contain an appropriate sampler chunk or could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.velHigh</strong></td><td style="text-align: left">The highest velocity of the velocity range stored in the sampler chunk of the audio file. Returns <code>nil</code> if the audio file does not contain an appropriate sampler chunk or could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.detune</strong></td><td style="text-align: left">The tune offset in cents stored in the sampler chunk of the audio file. Returns <code>nil</code> if the audio file does not contain an appropriate sampler chunk or could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.level</strong></td><td style="text-align: left">The level offset in dB stored in the sampler chunk of the audio file. Returns <code>nil</code> if the audio file does not contain an appropriate sampler chunk or could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.tempo</strong></td><td style="text-align: left">The tempo in bpm stored in a data chunk of the audio file. Returns <code>nil</code> if the audio file does not contain an appropriate data chunk or could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.beats</strong></td><td style="text-align: left">The number of beats stored in a data chunk of the audio file. Returns <code>nil</code> if the audio file does not contain an appropriate data chunk or could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.signature</strong></td><td style="text-align: left">A pair of values for the numerator and denominator of the signature stored in a data chunk of the audio file. The values are <code>nil</code> if the audio file does not contain an appropriate data chunk or could not be opened or is invalid.</td><td style="text-align: left">number, number</td></tr>
<tr><td style="text-align: left"><strong>.sampleStart</strong></td><td style="text-align: left">The position of the sample start in samples stored in a data chunk of the audio file. Returns <code>nil</code> if the audio file does not contain an appropriate data chunk or could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.sampleEnd</strong></td><td style="text-align: left">The position of the sample end in samples stored in a data chunk of the audio file. Returns <code>nil</code> if the audio file does not contain an appropriate data chunk or could not be opened or is invalid.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>.loops</strong></td><td style="text-align: left">The loop start and end positions in samples stored in a data chunk of the audio file. The returned table is an array that contains tables with the fields loopStart and loopEnd for each loop. Returns <code>nil</code> if the audio file does not contain an appropriate data chunk or could not be opened or is invalid.</td><td style="text-align: left">table</td></tr>
</tbody></table>
</div>
<h4 id="example"><a class="header" href="#example">Example</a></h4>
<pre><code class="language-lua">-- Open an audio file from HALion Sonic 1.0.

fname = "vstsound://502B301A6C914CEDA5C7500DC890C4DC/.Samples/g:/projects/yamahacontentserver/download/release/smtg/winds/Samples/DP060_FluteC3.wav"
af = AudioFile.open(fname)
loops = af.loops

-- Print information from the audio file.

if af.valid then
  print(fname, "opened.")
  print("Sample Rate: ", af.rate)
  print("Bit Depth: ", af.bits)
  print("Channels: ", af.channels)
  print("Sample Length: ", af.length)
  if loops then
    print("Loop Start: ", loops[1].loopStart)
    print("Loop End: ", loops[1].loopEnd)
  end
else
  print(fname, "does not exist.")
end
</code></pre>
<p><a href="#audio-file">Jump to Top </a></p>
<h2 id="methods"><a class="header" href="#methods">Methods</a></h2>
<h3 id="analyzepitch"><a class="header" href="#analyzepitch">analyzePitch</a></h3>
<blockquote>
<p><strong>analyzePitch(callback, channel)</strong></p>
</blockquote>
<p><span class="version-text">(Since HALion 6.3)</span></p>
<h4 id="description-1"><a class="header" href="#description-1">Description</a></h4>
<p>Function to analyze the pitch of an audio file. You specify the audio file with the <a href="./Audio-File.html">AudioFile</a> object that is returned by the <a href="./AudioFileopen.html">AudioFile.open</a> function. The arguments <code>callback</code> and <code>channel</code> are optional. If called without a callback function, analyzePitch will be executed in the same thread. If called with a callback function as argument, analyzePitch will be executed in a separate, parallel thread. You can specify the channel to be analyzed with the <code>channel</code> argument. Without the <code>channel</code> argument, multiple channels of an audio file will be summed before the pitch is analyzed. The callback function is called with the <a href="./Audio-File.html">AudioFile</a> object as the first and the <code>channel</code> as the second argument after the pitch has been analyzed. The results of analyzePitch are cashed for as long as the corresponding <a href="./Audio-File.html">AudioFile</a> object exists. The function itself does not return any pitch information. You must use <a href="./getPitch.html">getPitch</a> to obtain the analyzed pitch.</p>
<p><strong>Available in:</strong> Controller.</p>
<h4 id="arguments"><a class="header" href="#arguments">Arguments</a></h4>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Argument</th><th style="text-align: left">Description</th><th style="text-align: left">Value Type</th></tr></thead><tbody>
<tr><td style="text-align: left"><strong>callback</strong></td><td style="text-align: left">Callback function that is called with the AudioFile object as argument after the pitch has been analyzed.</td><td style="text-align: left">function, optional</td></tr>
<tr><td style="text-align: left"><strong>channel</strong></td><td style="text-align: left">Use this to specify the channel of the audio file to be analyzed. Leave this empty or set this to 0 for summing all audio channels before they are analyzed.</td><td style="text-align: left">number, optional</td></tr>
</tbody></table>
</div>
<h4 id="example-1"><a class="header" href="#example-1">Example</a></h4>
<pre><code class="language-lua">channelNames = { [0] = "All", "Left", "Right" }
  
defineParameter( "Channel", nil, 0, channelNames)
defineParameter( "Start", nil, false, function() if Start then onStart() end end)
defineParameter( "Cancel", nil, false)
  
-- Requires the Skylab content.
path = "vstsound://724ACB205EFF46F885735D1B216C37AD/.AppData/Steinberg/Skylab/Sub Presets/Layer Presets/Ambient Pads/Ambient Pad 01.vstpreset"
layer = loadPreset(path)
  
function onPitchAnalysisFinished(audioFile, channelNum)
    print("Progress: 100%")
    print(channelNames[channelNum].." channel(s) of "..audioFile.fileName.." analyzed.")
end
  
function onStart()
    zones = layer:findZones(true)
    for i, zone in ipairs(zones) do
        local samplePath = zone:getParameter("SampleOsc.Filename")
        print("File: "..samplePath)
        local afile = AudioFile.open(samplePath)
        afile:analyzePitch(onPitchAnalysisFinished, Channel)
        while afile:getPitchAnalysisProgress(Channel) &lt; 1 do
            if Cancel then
                afile:cancelPitchAnalysis(Channel)
                break
            end
            local progressPercent = 100 * afile:getPitchAnalysisProgress(Channel)
            print(string.format("Progress: %2d%%", progressPercent))
            wait(2000)
        end
        if Cancel then
            Cancel = false
            print("Canceled!")
            break
        end
        local pitch = afile:getPitch(0, -1, Channel)
        print("Analyzed Pitch: "..pitch)
    end
    print("Done!")
    Start = false
end
</code></pre>
<p><a href="#audio-file">Jump to Top </a></p>
<h3 id="canceldecompose"><a class="header" href="#canceldecompose">cancelDecompose</a></h3>
<blockquote>
<p><strong>cancelDecompose()</strong></p>
</blockquote>
<p><span class="version-text">(Since HALion 7.0)</span></p>
<h4 id="description-2"><a class="header" href="#description-2">Description</a></h4>
<p>Function to cancel the <a href="./decompose.html">decompose</a> function for an audio file. You specify the audio file with the <a href="./Audio-File.html">AudioFile</a> object that is returned by the <a href="./AudioFileopen.html">AudioFile.open</a> function. To cancel the decompose of a specific audio file, the <a href="./Audio-File.html">AudioFile</a> object of the cancelDecompose function must match the <a href="./Audio-File.html">AudioFile</a> object of the corresponding <a href="./decompose.html">decompose</a> function.</p>
<p><strong>Available in:</strong> Controller.</p>
<h4 id="example-2"><a class="header" href="#example-2">Example</a></h4>
<pre><code class="language-lua">outputModes = { "Tonal", "Noise", "All", "Mix", }
 
defineParameter { name = "Decompose", default = false, onChanged = function() if Decompose then onDecompose() end end }
defineParameter { name = "Cancel", default = false}
defineParameter { name = "Sensitivity", default = -24, min = -96, max = 0, increment = 0.1 }
defineParameter { name = "Cutoff", default = 20000, min = 20, max = 20000, increment = 1 }
defineParameter { name = "Duration", default = 80, min = 0, max = 100, increment = 0.1 }
defineParameter { name = "TonalLevel", default = 0, min = -96, max = 12, increment = 0.1 }
defineParameter { name = "NoiseLevel", default = 0, min = -96, max = 12, increment = 0.1 }
defineParameter { name = "Start", default = 0, min = 0, max = 1000, increment = 1 }
defineParameter { name = "Length", default = 0, min = 0, max = 1000, increment = 1 }
defineParameter { name = "OutputMode", default = DecomposeOutputMode.all, strings = outputModes }
defineParameter { name = "OutputPath", default = "" }
defineParameter { name = "Subfolder", default = "" }
 
function onDecomposeFinished(audioFile, file1, file2)
    print("Progress: 100%")
    print(audioFile.fileName, audioFile.length)
    if file1 then
        local afile1 = AudioFile.open(file1)
        print(afile1.fileName, afile1.length)
    end
    if file2 then
        local afile2 = AudioFile.open(file2)
        print(afile2.fileName, afile2.length)
    end
end
 
function onDecompose()
    zones = this.parent:findZones(true)
    for i, zone in ipairs(zones) do
        local samplePath = zone:getParameter("SampleOsc.Filename")
        local afile = AudioFile.open(samplePath)
        local startSamples = Start * afile.rate/1000
        local lengthSamples = Length * afile.rate/1000
        if not Subfolder == "" then
            if OutputPath == "" then
                OutputPath = getDecomposeOutputPath(samplePath)..Subfolder
            else
                OutputPath = OutputPath..Subfolder
            end
        end
        print("Decompose: "..samplePath)
        afile:decompose{
            callback = onDecomposeFinished,
            start = startSamples,
            length = lengthSamples,
            sensitivity = Sensitivity,
            cutoff = Cutoff,
            duration = Duration,
            tonalLevel = TonalLevel,
            noiseLevel = NoiseLevel,
            outputMode = OutputMode,
            outputPath = OutputPath,
        }
        while afile:getDecomposeProgress() &lt; 1 do
            if Cancel then
                afile:cancelDecompose()
                break
            end
            local progress, errorMessage = afile:getDecomposeProgress()
            if errorMessage then
                print(errorMessage)
                break
            end
            local progressPercent = 100 * progress
            print(string.format("Progress: %2d%%", progressPercent))
            wait(2000)
        end
        if Cancel then
            Cancel = false
            print("Decompose Canceled!")
            break
        end
    end
    print("Decompose finished.")
    Decompose = false
end
</code></pre>
<p><a href="#audio-file">Jump to Top </a></p>
<h3 id="cancelpitchanalysis"><a class="header" href="#cancelpitchanalysis">cancelPitchAnalysis</a></h3>
<blockquote>
<p><strong>cancelPitchAnalysis(channel)</strong></p>
</blockquote>
<p><span class="version-text">(Since HALion 6.3)</span></p>
<h4 id="description-3"><a class="header" href="#description-3">Description</a></h4>
<p>Function to cancel a pitch analysis you started with <a href="./analyzePitch.html">analyzePitch</a>. You specify the audio file with the <a href="./Audio-File.html">AudioFile</a> object that is returned by the <a href="./AudioFileopen.html">AudioFile.open</a> function. The <code>channel</code> argument specifies the channel of the audio file. The <a href="./Audio-File.html">AudioFile</a> object and the <code>channel</code> argument must match the call to <a href="./analyzePitch.html">analyzePitch</a>.</p>
<p><strong>Available in:</strong> Controller.</p>
<h4 id="arguments-1"><a class="header" href="#arguments-1">Arguments</a></h4>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Argument</th><th style="text-align: left">Description</th><th style="text-align: left">Value Type</th></tr></thead><tbody>
<tr><td style="text-align: left"><strong>channel</strong></td><td style="text-align: left">Use this to specify the channel of the audio file that is being analyzed.</td><td style="text-align: left">number, optional</td></tr>
</tbody></table>
</div>
<h4 id="example-3"><a class="header" href="#example-3">Example</a></h4>
<pre><code class="language-lua">channelNames = { [0] = "All", "Left", "Right" }
  
defineParameter( "Channel", nil, 0, channelNames)
defineParameter( "Start", nil, false, function() if Start then onStart() end end)
defineParameter( "Cancel", nil, false)
  
-- Requires the Skylab content.
path = "vstsound://724ACB205EFF46F885735D1B216C37AD/.AppData/Steinberg/Skylab/Sub Presets/Layer Presets/Ambient Pads/Ambient Pad 01.vstpreset"
layer = loadPreset(path)
  
function onPitchAnalysisFinished(audioFile, channelNum)
    print("Progress: 100%")
    print(channelNames[channelNum].." channel(s) of "..audioFile.fileName.." analyzed.")
end
  
function onStart()
    zones = layer:findZones(true)
    for i, zone in ipairs(zones) do
        local samplePath = zone:getParameter("SampleOsc.Filename")
        print("File: "..samplePath)
        local afile = AudioFile.open(samplePath)
        afile:analyzePitch(onPitchAnalysisFinished, Channel)
        while afile:getPitchAnalysisProgress(Channel) &lt; 1 do
            if Cancel then
                afile:cancelPitchAnalysis(Channel)
                break
            end
            local progressPercent = 100 * afile:getPitchAnalysisProgress(Channel)
            print(string.format("Progress: %2d%%", progressPercent))
            wait(2000)
        end
        if Cancel then
            Cancel = false
            print("Canceled!")
            break
        end
        local pitch = afile:getPitch(0, -1, Channel)
        print("Analyzed Pitch: "..pitch)
    end
    print("Done!")
    Start = false
end
</code></pre>
<p><a href="#audio-file">Jump to Top </a></p>
<h3 id="decompose"><a class="header" href="#decompose">decompose</a></h3>
<blockquote>
<p><strong>decompose{arguments}</strong></p>
</blockquote>
<p><span class="version-text">(Since HALion 7.0)</span></p>
<h4 id="description-4"><a class="header" href="#description-4">Description</a></h4>
<p>Function to decompose an audio file into its tonal and noise components. You specify the audio file with the <a href="./Audio-File.html">AudioFile</a> object that is returned by the <a href="./AudioFileopen.html">AudioFile.open</a> function. The decompose function can be configured with named arguments. The named arguments are optional and if called without, decompose will be executed with its default settings.</p>
<p><strong>Available in:</strong> Controller.</p>
<h4 id="arguments-2"><a class="header" href="#arguments-2">Arguments</a></h4>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Argument</th><th style="text-align: left">Description</th><th style="text-align: left">Value Type</th></tr></thead><tbody>
<tr><td style="text-align: left"><strong>callback</strong></td><td style="text-align: left">This callback function is called with the <a href="./Audio-File.html">AudioFile</a> object and the file path of the ouput sample(s) as arguments after the original sample has been decomposed. If called without a callback function, decompose will be executed in the same thread. If called with a callback function as argument, decompose will be executed in a separate, parallel thread.</td><td style="text-align: left">function, optional</td></tr>
<tr><td style="text-align: left"><strong>start</strong></td><td style="text-align: left">The start position in samples. The created samples are trimmed to this position. The default is 0 samples.</td><td style="text-align: left">number, optional</td></tr>
<tr><td style="text-align: left"><strong>length</strong></td><td style="text-align: left">The duration in samples. Set this to less than or equal to 0 to use all samples from the specified <code>start</code> to the end of the sample. By default, everything from <code>start</code> to the end of the sample is decomposed. The created samples are trimmed to this length.</td><td style="text-align: left">number, optional</td></tr>
<tr><td style="text-align: left"><strong>sensitivity</strong></td><td style="text-align: left">Determines the minimum level difference that is needed to distinguish the tonal from the noise signals. The sensitivity is specified in dB and the value range is from -96 to 0 dB. The default is -24 dB.</td><td style="text-align: left">number, optional</td></tr>
<tr><td style="text-align: left"><strong>cutoff</strong></td><td style="text-align: left">Sets the frequency limit below which the algorithm detects tonal signals. Any signals above the cutoff frequency are classified as noise, regardless of the <code>sensitivity</code> and <code>duration</code> arguments. The cutoff is specified in Hz and the value range is from 20 to 20000 Hz. The default is 20000 Hz.</td><td style="text-align: left">number, optional</td></tr>
<tr><td style="text-align: left"><strong>duration</strong></td><td style="text-align: left">Allows you to specify the minimum length for a tonal signal in milliseconds. Signals that are shorter than the specified duration are classified as noise, longer signals are classified as tonal. The value range is fom 0 to 100 ms. The default is 80 ms.</td><td style="text-align: left">number, optional</td></tr>
<tr><td style="text-align: left"><strong>tonalLevel</strong></td><td style="text-align: left">Specifies the level of the tonal component in dB. The value range is from -96 to +12 dB. The default is 0 dB.</td><td style="text-align: left">number, optional</td></tr>
<tr><td style="text-align: left"><strong>noiseLevel</strong></td><td style="text-align: left">Specifies the level of the noise component in dB. The value range is from -96 to +12 dB. The default is 0 dB.</td><td style="text-align: left">number, optional</td></tr>
<tr><td style="text-align: left"><strong>outputMode</strong></td><td style="text-align: left">Defines if only one of the components, both components, or a mix of them is created. See <a href="./Decompose-Output-Modes.html">Decompose Output Modes</a> for details.</td><td style="text-align: left">number, optional</td></tr>
<tr><td style="text-align: left"><strong>outputPath</strong></td><td style="text-align: left">Specifies the path for the decomposed audio files. If the string is empty, invalid, or nil, the file paths of the decompose settings of the plug-in will be used. The default is nil.</td><td style="text-align: left">string, optional</td></tr>
</tbody></table>
</div>
<blockquote>
<p>❕ Samples that were loaded from a VST Sound container can only be decomposed if the <code>ouputPath</code> argument is set to a valid file location. You can use <a href="./getDecomposeOutputPath.html">getDecomposeOutputPath</a> to obtain the file location from the decompose settings of the plug-in.</p>
</blockquote>
<h4 id="example-4"><a class="header" href="#example-4">Example</a></h4>
<pre><code class="language-lua">outputModes = { "Tonal", "Noise", "All", "Mix", }
 
defineParameter { name = "Decompose", default = false, onChanged = function() if Decompose then onDecompose() end end }
defineParameter { name = "Cancel", default = false}
defineParameter { name = "Sensitivity", default = -24, min = -96, max = 0, increment = 0.1 }
defineParameter { name = "Cutoff", default = 20000, min = 20, max = 20000, increment = 1 }
defineParameter { name = "Duration", default = 80, min = 0, max = 100, increment = 0.1 }
defineParameter { name = "TonalLevel", default = 0, min = -96, max = 12, increment = 0.1 }
defineParameter { name = "NoiseLevel", default = 0, min = -96, max = 12, increment = 0.1 }
defineParameter { name = "Start", default = 0, min = 0, max = 1000, increment = 1 }
defineParameter { name = "Length", default = 0, min = 0, max = 1000, increment = 1 }
defineParameter { name = "OutputMode", default = DecomposeOutputMode.all, strings = outputModes }
defineParameter { name = "OutputPath", default = "" }
defineParameter { name = "Subfolder", default = "" }
 
function onDecomposeFinished(audioFile, file1, file2)
    print("Progress: 100%")
    print(audioFile.fileName, audioFile.length)
    if file1 then
        local afile1 = AudioFile.open(file1)
        print(afile1.fileName, afile1.length)
    end
    if file2 then
        local afile2 = AudioFile.open(file2)
        print(afile2.fileName, afile2.length)
    end
end
 
function onDecompose()
    zones = this.parent:findZones(true)
    for i, zone in ipairs(zones) do
        local samplePath = zone:getParameter("SampleOsc.Filename")
        local afile = AudioFile.open(samplePath)
        local startSamples = Start * afile.rate/1000
        local lengthSamples = Length * afile.rate/1000
        if not Subfolder == "" then
            if OutputPath == "" then
                OutputPath = getDecomposeOutputPath(samplePath)..Subfolder
            else
                OutputPath = OutputPath..Subfolder
            end
        end
        print("Decompose: "..samplePath)
        afile:decompose{
            callback = onDecomposeFinished,
            start = startSamples,
            length = lengthSamples,
            sensitivity = Sensitivity,
            cutoff = Cutoff,
            duration = Duration,
            tonalLevel = TonalLevel,
            noiseLevel = NoiseLevel,
            outputMode = OutputMode,
            outputPath = OutputPath,
        }
        while afile:getDecomposeProgress() &lt; 1 do
            if Cancel then
                afile:cancelDecompose()
                break
            end
            local progress, errorMessage = afile:getDecomposeProgress()
            if errorMessage then
                print(errorMessage)
                break
            end
            local progressPercent = 100 * progress
            print(string.format("Progress: %2d%%", progressPercent))
            wait(2000)
        end
        if Cancel then
            Cancel = false
            print("Decompose Canceled!")
            break
        end
    end
    print("Decompose finished.")
    Decompose = false
end
</code></pre>
<p><a href="#audio-file">Jump to Top </a></p>
<h3 id="getdecomposeprogress"><a class="header" href="#getdecomposeprogress">getDecomposeProgress</a></h3>
<blockquote>
<p><strong>getDecomposeProgress()</strong></p>
</blockquote>
<p><span class="version-text">(Since HALion 7.0)</span></p>
<h4 id="description-5"><a class="header" href="#description-5">Description</a></h4>
<p>Function to monitor the progress of the <a href="./decompose.html">decompose</a> function for an audio file. You specify the audio file with the <a href="./Audio-File.html">AudioFile</a> object that is returned by the <a href="./AudioFileopen.html">AudioFile.open</a> function. To get the progress of a specific audio file that is being decomposed, the <a href="./Audio-File.html">AudioFile</a> object of the getDecomposeProgress function must match the <a href="./Audio-File.html">AudioFile</a> object of the corresponding <a href="./decompose.html">decompose</a> function. The function returns two values: the progress as a value between 0 and 1 and an error message if the decompose did not succeed.</p>
<p><strong>Available in:</strong> Controller.</p>
<h4 id="return-values"><a class="header" href="#return-values">Return Values</a></h4>
<p>Returns the progress as a float value between 0 and 1, and an error message if the decompose did not succeed. The error message returns <code>nil</code> if the decompose was successful.</p>
<h4 id="example-5"><a class="header" href="#example-5">Example</a></h4>
<pre><code class="language-lua">outputModes = { "Tonal", "Noise", "All", "Mix", }
 
defineParameter { name = "Decompose", default = false, onChanged = function() if Decompose then onDecompose() end end }
defineParameter { name = "Cancel", default = false}
defineParameter { name = "Sensitivity", default = -24, min = -96, max = 0, increment = 0.1 }
defineParameter { name = "Cutoff", default = 20000, min = 20, max = 20000, increment = 1 }
defineParameter { name = "Duration", default = 80, min = 0, max = 100, increment = 0.1 }
defineParameter { name = "TonalLevel", default = 0, min = -96, max = 12, increment = 0.1 }
defineParameter { name = "NoiseLevel", default = 0, min = -96, max = 12, increment = 0.1 }
defineParameter { name = "Start", default = 0, min = 0, max = 1000, increment = 1 }
defineParameter { name = "Length", default = 0, min = 0, max = 1000, increment = 1 }
defineParameter { name = "OutputMode", default = DecomposeOutputMode.all, strings = outputModes }
defineParameter { name = "OutputPath", default = "" }
defineParameter { name = "Subfolder", default = "" }
 
function onDecomposeFinished(audioFile, file1, file2)
    print("Progress: 100%")
    print(audioFile.fileName, audioFile.length)
    if file1 then
        local afile1 = AudioFile.open(file1)
        print(afile1.fileName, afile1.length)
    end
    if file2 then
        local afile2 = AudioFile.open(file2)
        print(afile2.fileName, afile2.length)
    end
end
 
function onDecompose()
    zones = this.parent:findZones(true)
    for i, zone in ipairs(zones) do
        local samplePath = zone:getParameter("SampleOsc.Filename")
        local afile = AudioFile.open(samplePath)
        local startSamples = Start * afile.rate/1000
        local lengthSamples = Length * afile.rate/1000
        if not Subfolder == "" then
            if OutputPath == "" then
                OutputPath = getDecomposeOutputPath(samplePath)..Subfolder
            else
                OutputPath = OutputPath..Subfolder
            end
        end
        print("Decompose: "..samplePath)
        afile:decompose{
            callback = onDecomposeFinished,
            start = startSamples,
            length = lengthSamples,
            sensitivity = Sensitivity,
            cutoff = Cutoff,
            duration = Duration,
            tonalLevel = TonalLevel,
            noiseLevel = NoiseLevel,
            outputMode = OutputMode,
            outputPath = OutputPath,
        }
        while afile:getDecomposeProgress() &lt; 1 do
            if Cancel then
                afile:cancelDecompose()
                break
            end
            local progress, errorMessage = afile:getDecomposeProgress()
            if errorMessage then
                print(errorMessage)
                break
            end
            local progressPercent = 100 * progress
            print(string.format("Progress: %2d%%", progressPercent))
            wait(2000)
        end
        if Cancel then
            Cancel = false
            print("Decompose Canceled!")
            break
        end
    end
    print("Decompose finished.")
    Decompose = false
end
</code></pre>
<p><a href="#audio-file">Jump to Top </a></p>
<h3 id="getonsets"><a class="header" href="#getonsets">getOnsets</a></h3>
<blockquote>
<p><strong>getOnsets(start, length, peakThreshold, sensThreshold, minLength)</strong></p>
</blockquote>
<p><span class="version-text">(Since HALion 6.4.0)</span></p>
<h4 id="description-6"><a class="header" href="#description-6">Description</a></h4>
<p>Function to analyze the onsets in an audio file. You specify the audio file with the <a href="./Audio-File.html">AudioFile</a> object that is returned by the <a href="./AudioFileopen.html">AudioFile.open</a> function. The onset analysis is performed on the sum of all channels in the audio file. The arguments <code>start</code>  and <code>length</code>  define the time range in the audio file to be analyzed. The <code>peakThreshold</code>  and <code>sensThreshold</code>  arguments determine the minimum level and the weight of an onset, the <code>minLength</code>  argument determines the minimum duration between consecutive onsets.</p>
<p><strong>Available in:</strong> Controller.</p>
<h4 id="arguments-3"><a class="header" href="#arguments-3">Arguments</a></h4>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Argument</th><th style="text-align: left">Description</th><th style="text-align: left">Value Type</th></tr></thead><tbody>
<tr><td style="text-align: left"><strong>start</strong></td><td style="text-align: left">The start position in samples.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>length</strong></td><td style="text-align: left">The duration in samples. Set this to equal to or less than 0 to use all samples from the specified <code>start</code> to the end of the sample.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>peakThreshold</strong></td><td style="text-align: left">The minimum level in decibels. Onsets with a lower level are skipped. The value range is from -96 to 0.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>sensThreshold</strong></td><td style="text-align: left">The minimum weight in percent. Onsets with a lower weight are skipped. The value range is from 0 to 100.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>minLength</strong></td><td style="text-align: left">The minimum duration between consecutive onsets in milliseconds. The value range is from 0 to 10000.</td><td style="text-align: left">number</td></tr>
</tbody></table>
</div>
<h4 id="return-values-1"><a class="header" href="#return-values-1">Return Values</a></h4>
<p>Returns an array with the positions of the detected onsets.</p>
<h4 id="example-6"><a class="header" href="#example-6">Example</a></h4>
<pre><code class="language-lua">fname = "vstsound://271CB2CFA75E4295B1C273FA651FE11D/.Samples/g:/projects/yamahacontentserver/Download/Release/ycj/ME_Waveform/Loop145/samples/Loop145_072(2).wav"
 
af = AudioFile.open(fname)
 
onsets = af:getOnsets(0, -1, -24, 0, 10)
  
for i, pos in ipairs(onsets) do
   print(i.." ".."Onset: "..pos)
end
</code></pre>
<p><a href="#audio-file">Jump to Top </a></p>
<h3 id="getpeak"><a class="header" href="#getpeak">getPeak</a></h3>
<blockquote>
<p><strong>getPeak(start, length, rms)</strong></p>
</blockquote>
<h4 id="description-7"><a class="header" href="#description-7">Description</a></h4>
<p>Function to analyze the levels in an audio file. You specify the audio file with the <a href="./Audio-File.html">AudioFile</a> object that is returned by the <a href="./AudioFileopen.html">AudioFile.open</a> function. The arguments start and length define the range in the audio file to be analyzed. The rms argument determines whether the peak level or the RMS level of the specified range is returned.</p>
<p><strong>Available in:</strong> Controller.</p>
<h4 id="arguments-4"><a class="header" href="#arguments-4">Arguments</a></h4>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Argument</th><th style="text-align: left">Description</th><th style="text-align: left">Value Type</th></tr></thead><tbody>
<tr><td style="text-align: left"><strong>start</strong></td><td style="text-align: left">The start position in samples.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>length</strong></td><td style="text-align: left">The duration in samples. Set this to equal to or less than 0 to use all samples from the specified start to the end of the file.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>rms</strong></td><td style="text-align: left">If this is set to 0, the peak level of the specified range will be returned. If this is set to a value above 0, the RMS level over the specified range will be calculated.</td><td style="text-align: left">number</td></tr>
</tbody></table>
</div>
<h4 id="return-values-2"><a class="header" href="#return-values-2">Return Values</a></h4>
<p>Returns the level of the specifed range as a linear value. The example shows how to convert the value from linear to dB.</p>
<h4 id="example-7"><a class="header" href="#example-7">Example</a></h4>
<pre><code class="language-lua">function lin2db(lin)
  return 20 * math.log(lin) / math.log(10)
end

fname = "vstsound://F29C895D6D8E4D6C9BCBBA5198412192/.samples/Ambient Pad 01/Ambient Pad 01 - C3.tg3c"
af = AudioFile.open(fname)

-- Analyze the peak level in the first 1000 samples.

attpeak = af:getPeak(0, 1000, 0)

-- Analyze the RMS level in the range from 1000 samples till the end of the file.

susrms = af:getPeak(1000, -1, 1)
print("Attack Peak:", attpeak, "(", lin2db(attpeak), "dB )")
print("Sustain RMS:", susrms, "(", lin2db(susrms), "dB )")
</code></pre>
<p><a href="#audio-file">Jump to Top </a></p>
<h3 id="getpitch"><a class="header" href="#getpitch">getPitch</a></h3>
<blockquote>
<p><strong>getPitch(start, length, channel)</strong></p>
</blockquote>
<p><span class="version-text">(Since HALion 6.3)</span></p>
<h4 id="description-8"><a class="header" href="#description-8">Description</a></h4>
<p>Function to obtain the pitch of an audio file that has been analyzed with <a href="./analyzePitch.html">analyzePitch</a>. The audio file you want to obtain the pitch from is specified with the <a href="./Audio-File.html">AudioFile</a> object that is returned by the <a href="./AudioFileopen.html">AudioFile.open</a> function. The arguments <code>start</code> and <code>length</code> define the range in the audio file that is used for obtaining the pitch. The <code>channel</code> argument specifies the channel of the audio file that was analyzed. The <a href="./Audio-File.html">AudioFile</a> object and the <code>channel</code> argument must match the call to <a href="./analyzePitch.html">analyzePitch</a>. The function returns two values: The pitch as MIDI note number with decimals for cents and a boolean for voiced/unvoiced detection. If <code>length</code> is greater than 20 ms, the average of the pitches in the specified range is returned. If the audio file has not been analyzed in advance, getPitch returns <code>nil</code>.</p>
<p><strong>Available in:</strong> Controller.</p>
<h4 id="arguments-5"><a class="header" href="#arguments-5">Arguments</a></h4>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Argument</th><th style="text-align: left">Description</th><th style="text-align: left">Value Type</th></tr></thead><tbody>
<tr><td style="text-align: left"><strong>start</strong></td><td style="text-align: left">The start position in samples.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>length</strong></td><td style="text-align: left">The duration in samples. Set this to less than or equal to 0 to use all samples from the specified <code>start</code> to the end of the file.</td><td style="text-align: left">number</td></tr>
<tr><td style="text-align: left"><strong>channel</strong></td><td style="text-align: left">Use this to specify the audio channel that was analyzed.</td><td style="text-align: left">number, optional</td></tr>
</tbody></table>
</div>
<h4 id="return-values-3"><a class="header" href="#return-values-3">Return Values</a></h4>
<p>Returns two values:</p>
<ul>
<li>A float value representing the pitch as MIDI note number with decimals for cents,</li>
<li>a boolean for voiced/unvoiced detection. The return value <code>true</code> means that a pitch was detected in the specified range.</li>
</ul>
<p>If <code>length</code> is greater than 20 ms, the average of the pitches in the specified range is returned. If the audio file has not been analyzed in advance, getPitch returns <code>nil</code>.</p>
<h4 id="example-8"><a class="header" href="#example-8">Example</a></h4>
<pre><code class="language-lua">channelNames = { [0] = "All", "Left", "Right" }
  
defineParameter( "Channel", nil, 0, channelNames)
defineParameter( "Start", nil, false, function() if Start then onStart() end end)
defineParameter( "Cancel", nil, false)
  
-- Requires the Skylab content.
path = "vstsound://724ACB205EFF46F885735D1B216C37AD/.AppData/Steinberg/Skylab/Sub Presets/Layer Presets/Ambient Pads/Ambient Pad 01.vstpreset"
layer = loadPreset(path)
  
function onPitchAnalysisFinished(audioFile, channelNum)
    print("Progress: 100%")
    print(channelNames[channelNum].." channel(s) of "..audioFile.fileName.." analyzed.")
end
  
function onStart()
    zones = layer:findZones(true)
    for i, zone in ipairs(zones) do
        local samplePath = zone:getParameter("SampleOsc.Filename")
        print("File: "..samplePath)
        local afile = AudioFile.open(samplePath)
        afile:analyzePitch(onPitchAnalysisFinished, Channel)
        while afile:getPitchAnalysisProgress(Channel) &lt; 1 do
            if Cancel then
                afile:cancelPitchAnalysis(Channel)
                break
            end
            local progressPercent = 100 * afile:getPitchAnalysisProgress(Channel)
            print(string.format("Progress: %2d%%", progressPercent))
            wait(2000)
        end
        if Cancel then
            Cancel = false
            print("Canceled!")
            break
        end
        local pitch = afile:getPitch(0, -1, Channel)
        print("Analyzed Pitch: "..pitch)
    end
    print("Done!")
    Start = false
end
</code></pre>
<p><a href="#audio-file">Jump to Top </a></p>
<h3 id="getpitchanalysisprogress"><a class="header" href="#getpitchanalysisprogress">getPitchAnalysisProgress</a></h3>
<blockquote>
<p><strong>getPitchAnalysisProgress(channel)</strong></p>
</blockquote>
<p><span class="version-text">(Since HALion 6.3)</span></p>
<h4 id="description-9"><a class="header" href="#description-9">Description</a></h4>
<p>Function to monitor the progress of <a href="./analyzePitch.html">analyzePitch</a>. You specify the audio file with the <a href="./Audio-File.html">AudioFile</a> object that is returned by the <a href="./AudioFileopen.html">AudioFile.open</a> function. The <code>channel</code> argument specifies the channel of the audio file. The <a href="./Audio-File.html">AudioFile</a> object and the channel argument must match the call to <a href="./analyzePitch.html">analyzePitch</a>. The function returns the progress as a float value between 0 and 1.</p>
<p><strong>Available in:</strong> Controller.</p>
<h4 id="arguments-6"><a class="header" href="#arguments-6">Arguments</a></h4>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Argument</th><th style="text-align: left">Description</th><th style="text-align: left">Value Type</th></tr></thead><tbody>
<tr><td style="text-align: left"><strong>channel</strong></td><td style="text-align: left">Use this to specify the channel of the audio file that is being analyzed.</td><td style="text-align: left">number, optional</td></tr>
</tbody></table>
</div>
<h4 id="return-values-4"><a class="header" href="#return-values-4">Return Values</a></h4>
<p>Returns the progress as a float value between 0 and 1.</p>
<h4 id="example-9"><a class="header" href="#example-9">Example</a></h4>
<pre><code class="language-lua">channelNames = { [0] = "All", "Left", "Right" }
  
defineParameter( "Channel", nil, 0, channelNames)
defineParameter( "Start", nil, false, function() if Start then onStart() end end)
defineParameter( "Cancel", nil, false)
  
-- Requires the Skylab content.
path = "vstsound://724ACB205EFF46F885735D1B216C37AD/.AppData/Steinberg/Skylab/Sub Presets/Layer Presets/Ambient Pads/Ambient Pad 01.vstpreset"
layer = loadPreset(path)
  
function onPitchAnalysisFinished(audioFile, channelNum)
    print("Progress: 100%")
    print(channelNames[channelNum].." channel(s) of "..audioFile.fileName.." analyzed.")
end
  
function onStart()
    zones = layer:findZones(true)
    for i, zone in ipairs(zones) do
        local samplePath = zone:getParameter("SampleOsc.Filename")
        print("File: "..samplePath)
        local afile = AudioFile.open(samplePath)
        afile:analyzePitch(onPitchAnalysisFinished, Channel)
        while afile:getPitchAnalysisProgress(Channel) &lt; 1 do
            if Cancel then
                afile:cancelPitchAnalysis(Channel)
                break
            end
            local progressPercent = 100 * afile:getPitchAnalysisProgress(Channel)
            print(string.format("Progress: %2d%%", progressPercent))
            wait(2000)
        end
        if Cancel then
            Cancel = false
            print("Canceled!")
            break
        end
        local pitch = afile:getPitch(0, -1, Channel)
        print("Analyzed Pitch: "..pitch)
    end
    print("Done!")
    Start = false
end
</code></pre>
<p><a href="#audio-file">Jump to Top </a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../HALion-Script/pages/Class-Reference.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../HALion-Script/pages/Element.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>

            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../HALion-Script/pages/Class-Reference.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../HALion-Script/pages/Element.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>
            
            <div id="footer" class="footer">
                <!-- Here comes the footer when available -->
                © 2025 <a href="https://www.steinberg.net" target="_blank">Steinberg Media Technologies GmbH</a>.&nbsp; All rights reserved.&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="https://o.steinberg.net/en/extras/about.html" target="_blank">About</a> |
                <a href="https://o.steinberg.net/en/extras/privacy_policy.html" target="_blank">Privacy Policy</a> |
                <a href="https://o.steinberg.net/en/extras/terms_conditions.html" target="_blank">Legal Terms</a> 
            </div>
        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../mermaid.min.js"></script>
        <script src="../../mermaid-init.js"></script>


    </div>
    </body>
</html>
